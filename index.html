<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#FFF0F5">
<title>é—œæ±ä¹‹æ—… 2026 (V69.0 è‡ªé§•ä¿®å¾©ç‰ˆ)</title>

<script src="https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700;900&display=swap" rel="stylesheet">

<script>
    window.tailwind = {
        config: {
            theme: {
                extend: {
                    colors: { 'chii-pink': '#FFD1DC', 'chii-blue': '#A2D2FF', 'chii-yellow': '#FFF5BA' },
                    fontFamily: { sans: ['Zen Maru Gothic', 'sans-serif'] },
                    animation: { 'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)', 'pulse-fast': 'pulse 1.5s infinite' },
                    keyframes: { pop: { '0%': { transform: 'scale(0)' }, '100%': { transform: 'scale(1)' } } }
                }
            }
        }
    }
</script>

<style>
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; font-family: "Zen Maru Gothic", sans-serif; background-color: #FFF0F5; overflow: hidden; -webkit-tap-highlight-color: transparent; }
    #fixed-bg { position: fixed; inset: 0; z-index: -1; background: radial-gradient(#FFD1DC 15%, transparent 16%) 0 0, radial-gradient(#FFF5BA 15%, transparent 16%) 30px 30px; background-size: 60px 60px; opacity: 0.5; }
    #app-content { height: 100%; overflow-y: auto; padding-bottom: 120px; padding-top: env(safe-area-inset-top); }
    [v-cloak] { display: none !important; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    
    .card { background: rgba(255,255,255,0.95); border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 2px solid white; margin-bottom: 12px; position: relative; overflow: hidden; }
    .btn-push:active { transform: scale(0.95); transition: transform 0.1s; }
    
    .online-avatar { width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; background: #eee; position: relative; margin-left: -8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .online-avatar.active { border-color: #4ade80; z-index: 10; transform: translateY(-2px); }
    
    .fab-home { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 60px; height: 60px; background: linear-gradient(135deg, #FF9EAC, #FFD1DC); border-radius: 50%; border: 4px solid white; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; box-shadow: 0 10px 20px rgba(0,0,0,0.2); z-index: 50; }
    
    .hp-bar { height: 6px; background: #eee; border-radius: 3px; overflow: hidden; margin-top: 4px; }
    .hp-fill { height: 100%; }
    .hp-high { background: #4ade80; } .hp-mid { background: #facc15; } .hp-low { background: #f87171; }
    
    .cvs-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .cvs-card { background: white; border-radius: 16px; padding: 10px; text-align: center; border: 1px solid #eee; }
    
    .timeline-line { position: absolute; left: 19px; top: 30px; bottom: -20px; width: 2px; background: #e5e7eb; z-index: 0; }
</style>
</head>
<body>

<div id="fixed-bg"></div>

<div id="app" v-cloak class="h-full flex flex-col relative">

    <div v-if="isLoading" class="fixed inset-0 z-[9999] bg-[#FFF0F5] flex flex-col items-center justify-center">
        <div class="text-4xl animate-bounce">ğŸš—</div>
        <div class="mt-4 font-bold text-pink-500">æ­£åœ¨ç™¼å‹•å¼•æ“ (è¼‰å…¥è‡ªé§•è¡Œç¨‹)...</div>
    </div>

    <div v-if="!isWelcomeClosed" class="h-full flex flex-col items-center justify-center p-6 relative">
        <div class="absolute inset-0 z-0"><img :src="getUnsplashUrl('mount fuji road')" class="w-full h-full object-cover opacity-60"></div>
        <div class="relative z-10 text-center bg-white/30 backdrop-blur-md p-8 rounded-3xl border border-white/50 shadow-xl">
            <h1 class="text-5xl font-black text-white drop-shadow-md mb-2">é—œæ±ä¹‹æ—…</h1>
            <p class="text-xl text-white font-bold tracking-widest">2026.03.27</p>
            <button @click="enterSite" class="mt-8 w-full bg-white text-pink-500 font-black py-3 rounded-full shadow-lg btn-push">é€²å…¥æ—…ç¨‹</button>
        </div>
    </div>

    <div v-if="isWelcomeClosed" class="h-full flex flex-col">
        <div v-if="currentView!=='menu'" class="h-[60px] shrink-0 flex items-center justify-between px-4 bg-white/80 backdrop-blur z-20">
            <button @click="currentView='menu'" class="w-8 h-8 bg-white rounded-full shadow flex items-center justify-center text-pink-400 btn-push"><i class="fa-solid fa-chevron-left"></i></button>
            <h1 class="font-black text-gray-700">{{getPageTitle(currentView)}}</h1>
            <div class="w-8"></div>
        </div>

        <div id="app-content" class="flex-1 px-4 py-4">
            
            <div v-if="currentView==='menu'" class="pt-6 pb-24">
                <div class="flex justify-between items-center mb-6">
                    <button @click="isWelcomeClosed=false" class="text-xs bg-white text-gray-500 px-3 py-1 rounded-full border shadow-sm btn-push"><i class="fa-solid fa-house"></i> å›é¦–é </button>
                    <div class="flex pl-2"><div v-for="u in users" :key="u.id" class="online-avatar flex items-center justify-center text-xs" :class="{active:true}">{{u.icon}}</div></div>
                </div>

                <div class="bg-white rounded-2xl p-5 shadow-lg border-2 border-white mb-6 relative overflow-hidden">
                    <div v-if="budgetAlert" class="bg-red-100 text-red-600 text-xs font-bold px-2 py-1 rounded mb-2 inline-block animate-pulse">âš ï¸ é ç®—å·²ä½¿ç”¨è¶…é 80%ï¼</div>
                    
                    <div v-if="daysUntilTrip > 0">
                        <div class="text-xs font-bold text-gray-400 mb-1">å‡ºç™¼å‰æª¢æŸ¥ (æ•´å‚™æ¨¡å¼)</div>
                        <div v-if="getUncheckedCount() > 0" class="text-red-500 font-bold mb-2"><i class="fa-solid fa-triangle-exclamation"></i> é‚„æœ‰ {{getUncheckedCount()}} é …è¡Œæ/è­‰ä»¶æœªæº–å‚™ï¼</div>
                        <div v-else class="text-green-500 font-bold mb-2"><i class="fa-solid fa-check-circle"></i> è¡Œææº–å‚™å°±ç·’</div>
                        <div class="space-y-1">
                            <div class="text-xs font-bold text-pink-500"><i class="fa-solid fa-ticket"></i> è¨˜å¾—æ¶ï¼šå¯Œå£«å›éŠè™Ÿ (30å¤©å‰)</div>
                            <div class="text-xs font-bold text-orange-500"><i class="fa-solid fa-camera"></i> è¨˜å¾—æ¶ï¼šSHIBUYA SKY é»ƒæ˜ç¥¨</div>
                        </div>
                    </div>
                    <div v-else>
                        <div class="text-xs font-bold text-blue-400 mb-1">æ—…ç¨‹ä¸­æƒ…å ± (æ±äº¬)</div>
                        <div class="text-2xl font-black text-gray-800 mb-1">18Â°C <span class="text-sm text-gray-500">æ™´æ™‚å¤šé›²</span></div>
                        <div class="text-xs text-gray-600 font-bold">ğŸ‘• ç©¿æ­ï¼šå¤§è¡£ + ç™¼ç†±è¡£ (æ—©æ™šæº«å·®å¤§)</div>
                        <div v-if="shopping.cosme.length>0" class="mt-2 pt-2 border-t border-gray-100 text-xs text-pink-500 font-bold">ğŸ›ï¸ é‚„æœ‰ {{shopping.cosme.length}} å€‹è—¥å¦å¾…è²·</div>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-3">
                    <div v-for="app in apps" :key="app.id" @click="currentView=app.view" class="flex flex-col items-center btn-push">
                        <div class="w-16 h-16 rounded-2xl flex items-center justify-center text-2xl text-white shadow-md mb-1" :class="app.bgClass"><i :class="app.icon"></i></div>
                        <span class="text-xs font-bold text-gray-600">{{app.name}}</span>
                    </div>
                </div>
            </div>

            <div v-if="currentView==='itinerary'">
                <div class="flex gap-2 overflow-x-auto hide-scrollbar mb-4 sticky top-0 z-10 bg-[#FFF0F5] py-2">
                    <button v-for="(d,i) in tripDays" :key="i" @click="dayIdx=i" :class="['px-4 py-2 rounded-xl border-2 font-bold text-sm min-w-[60px]', dayIdx===i?'bg-pink-400 text-white border-pink-400':'bg-white text-gray-400 border-white']">
                        {{d.label}}
                        <div class="hp-bar"><div class="hp-fill" :class="d.hp>70?'hp-high':d.hp>40?'hp-mid':'hp-low'" :style="{width:d.hp+'%'}"></div></div>
                    </button>
                </div>
                
                <div v-if="dayIdx===2 || dayIdx===3" class="flex justify-center mb-4">
                    <div class="bg-white p-1 rounded-full shadow border flex">
                        <button @click="driveMode=false" :class="['px-4 py-1 rounded-full text-xs font-bold transition', !driveMode?'bg-pink-400 text-white':'text-gray-400']">ä¸€èˆ¬äº¤é€š</button>
                        <button @click="driveMode=true" :class="['px-4 py-1 rounded-full text-xs font-bold transition', driveMode?'bg-green-500 text-white':'text-gray-400']"><i class="fa-solid fa-car"></i> å¯Œå£«å±±è‡ªé§•</button>
                    </div>
                </div>
                
                <div class="space-y-4 pb-20 px-1">
                    <div v-for="(item, idx) in getCurrentItinerary()" :key="idx" class="relative pl-12 group">
                        <div class="timeline-line" v-if="idx < getCurrentItinerary().length - 1"></div>
                        
                        <div class="absolute left-0 top-0 w-10 text-center">
                            <span class="text-xs font-black text-gray-400 block">{{item.time}}</span>
                            <div class="w-3 h-3 rounded-full border-2 bg-white mt-1 mx-auto z-10 relative" :class="driveMode && (dayIdx===2||dayIdx===3)?'border-green-500':'border-pink-400'"></div>
                        </div>
                        
                        <div class="card p-3 ml-2 relative z-10" :class="{'border-l-4 border-l-green-500': driveMode && (dayIdx===2||dayIdx===3)}">
                            <h3 class="font-black text-gray-800">{{item.title}}</h3>
                            <p class="text-xs text-gray-500 font-bold mb-2">{{item.desc}}</p>
                            <div class="flex gap-2">
                                <a :href="item.map || getMapLink(item.title)" target="_blank" class="bg-blue-50 text-blue-500 px-2 py-1 rounded-lg text-xs font-bold flex items-center gap-1 active:scale-95"><i class="fa-solid fa-location-arrow"></i> å°èˆª</a>
                                <a v-if="driveMode && (dayIdx===2||dayIdx===3)" :href="getMapLink(item.title + ' é§è»Šå ´')" target="_blank" class="bg-green-50 text-green-600 px-2 py-1 rounded-lg text-xs font-bold flex items-center gap-1 active:scale-95"><i class="fa-solid fa-square-parking"></i> åœè»Šå ´</a>
                            </div>
                        </div>
                    </div>
                    <div v-if="getCurrentItinerary().length===0" class="text-center text-gray-400 text-xs py-10">æœ¬æ—¥ç„¡è¡Œç¨‹è³‡æ–™</div>
                </div>
            </div>

            <div v-if="currentView==='money'">
                <div class="flex justify-center gap-2 mb-4">
                    <button @click="moneyMode='private'" :class="['px-6 py-2 rounded-full font-bold text-xs', moneyMode==='private'?'bg-yellow-400 text-white':'bg-white text-gray-400']">å€‹äººç§å¸³</button>
                    <button @click="moneyMode='public'" :class="['px-6 py-2 rounded-full font-bold text-xs', moneyMode==='public'?'bg-blue-400 text-white':'bg-white text-gray-400']">å…¬æ¬¾åˆ†å¸³</button>
                </div>
                <div class="bg-white p-3 rounded-xl mb-4 border shadow-sm flex justify-between items-center">
                    <span class="text-xs font-bold text-gray-400">ç›®å‰åŒ¯ç‡ (JPY)</span>
                    <input v-model="rate" type="number" class="w-16 text-right font-black text-gray-700 outline-none" step="0.001">
                </div>

                <div v-if="moneyMode==='public'">
                    <div class="bg-blue-50 p-4 rounded-xl mb-4 border border-blue-100">
                        <h3 class="font-bold text-blue-600 text-sm mb-2">ğŸ’° çµç®—ä¸­å¿ƒ (å³æ™‚é€æ˜åŒ–)</h3>
                        <div v-for="s in settlements" class="flex justify-between text-xs font-bold border-b border-blue-100 py-1">
                            <span>{{s.from}} <i class="fa-solid fa-arrow-right text-gray-400"></i> {{s.to}}</span>
                            <span class="text-blue-500">${{Math.round(s.amount)}}</span>
                        </div>
                        <div v-if="settlements.length===0" class="text-xs text-gray-400">ç›®å‰ç„¡æ¬ æ¬¾</div>
                    </div>
                    <div v-for="exp in publicExpenses" class="card p-3 flex justify-between">
                        <div><div class="font-bold">{{exp.item}}</div><div class="text-xs text-gray-400">{{exp.payer}} å¢Šä»˜ ({{exp.share}}äººåˆ†)</div></div>
                        <div class="font-black text-blue-500">{{exp.currency}} {{exp.amount}}</div>
                    </div>
                </div>
                
                <div v-if="moneyMode==='private'">
                    <div class="bg-yellow-50 p-4 rounded-xl mb-4 border border-yellow-100 text-center">
                        <div class="text-xs font-bold text-yellow-600">å€‹äººç¸½æ”¯å‡º</div>
                        <div class="text-3xl font-black text-yellow-500">NT$ {{Math.round(myTotal)}}</div>
                    </div>
                    <div v-for="exp in myExpenses" class="card p-3 flex justify-between">
                        <div class="font-bold">{{exp.item}}</div>
                        <div class="font-black text-gray-600">{{exp.currency}} {{exp.amount}}</div>
                    </div>
                </div>
                <button @click="addExpense" class="fab-home bg-yellow-400 text-white"><i class="fa-solid fa-plus"></i></button>
            </div>

            <div v-if="currentView==='hotel'">
                <div class="flex gap-2 overflow-x-auto hide-scrollbar mb-4">
                    <button v-for="t in ['ä½å®¿','æ©Ÿç¥¨','ç§Ÿè»Š','äº¤é€šç¥¨']" @click="hotelTab=t" :class="['px-4 py-2 rounded-full font-bold text-xs whitespace-nowrap', hotelTab===t?'bg-indigo-500 text-white':'bg-white text-gray-400']">{{t}}</button>
                </div>
                
                <div v-if="hotelTab==='ä½å®¿'" class="space-y-4">
                    <div class="card p-0" v-for="h in hotels" :key="h.name">
                        <div class="h-32 bg-gray-200 relative"><img :src="getUnsplashUrl(h.key)" class="w-full h-full object-cover"><div class="absolute bottom-2 left-3 text-white font-black text-lg shadow-black drop-shadow-md">{{h.name}}</div></div>
                        <div class="p-3"><a :href="h.link" target="_blank" class="block w-full bg-indigo-50 text-indigo-500 text-center font-bold py-2 rounded-lg text-sm">å°èˆªå‰å¾€</a></div>
                    </div>
                </div>

                <div v-if="hotelTab==='æ©Ÿç¥¨'" class="space-y-4">
                    <div class="card p-4 border-l-4 border-blue-500">
                        <h3 class="font-black mb-2">å»ç¨‹: é…·èˆª TR898</h3>
                        <div class="text-xs font-bold text-gray-500">06:40 TPE (T1) -> 10:40 NRT (T1)</div>
                    </div>
                    <div class="card p-4 border-l-4 border-indigo-500">
                        <h3 class="font-black mb-2">å›ç¨‹: é…·èˆª/å…¶ä»–</h3>
                        <div class="text-xs font-bold text-gray-500">20:40 NRT -> 23:20 TPE</div>
                    </div>
                </div>

                <div v-if="hotelTab==='ç§Ÿè»Š'" class="card p-4">
                    <h3 class="font-black text-lg mb-1">Toyota Rent a Car</h3>
                    <p class="text-xs font-bold text-gray-500 mb-3">å–è»Šï¼šæ²³å£æ¹–ç«™å‰åº— (3å¤©2å¤œ)</p>
                    <a href="https://rent.toyota.co.jp/" target="_blank" class="block w-full bg-green-500 text-white text-center font-bold py-2 rounded-lg text-sm">å®˜ç¶²é ç´„ç¢ºèª</a>
                </div>

                <div v-if="hotelTab==='äº¤é€šç¥¨'" class="space-y-3">
                    <div class="card p-3 flex justify-between items-center"><div><div class="font-bold">Suica è¥¿ç“œå¡</div><div class="text-xs text-gray-400">æ‰‹æ©Ÿç¶å®š/å¯¦é«”å¡</div></div><a href="https://www.jreast.co.jp/" class="bg-pink-500 text-white px-3 py-1 rounded text-xs font-bold">å®˜ç¶²</a></div>
                    <div class="card p-3 flex justify-between items-center border-l-4 border-red-500"><div><div class="font-bold text-red-500">å¯Œå£«å›éŠè™Ÿ (å¿…æ¶)</div><div class="text-xs text-gray-400">Eki-net 30å¤©å‰é ç´„</div></div><a href="https://www.eki-net.com/" class="bg-red-500 text-white px-3 py-1 rounded text-xs font-bold">æ¶ç¥¨</a></div>
                </div>
            </div>

            <div v-if="currentView==='prep'">
                <a href="https://vjw-lp.digital.go.jp/zh-hant/" target="_blank" class="card p-4 bg-blue-500 text-white border-none mb-4 flex items-center justify-between">
                    <div><div class="font-black text-lg">Visit Japan Web</div><div class="text-xs opacity-80">å…¥å¢ƒå¯©æŸ¥ / æµ·é—œç”³å ±</div></div><i class="fa-solid fa-chevron-right"></i>
                </a>
                <div class="card p-0">
                    <div class="bg-gray-50 p-3 font-bold border-b">æˆ‘çš„è¡Œææ¸…å–®</div>
                    <div v-for="(item,i) in myPrepList" :key="i" class="p-3 border-b flex items-center">
                        <input type="checkbox" v-model="item.checked" class="mr-3 w-5 h-5 accent-pink-500">
                        <span :class="item.checked?'line-through text-gray-300':'text-gray-700 font-bold'">{{item.text}}</span>
                    </div>
                </div>
            </div>

            <div v-if="currentView==='food'">
                <div class="flex gap-2 justify-center mb-4">
                    <button v-for="l in ['æ±äº¬','éŒå€‰','å¯Œå£«å±±','ä¾¿åˆ©å•†åº—']" @click="foodLoc=l" :class="['px-3 py-2 rounded-full font-bold text-xs', foodLoc===l?'bg-orange-400 text-white':'bg-white text-gray-400']">{{l}}</button>
                </div>
                
                <div v-if="foodLoc!=='ä¾¿åˆ©å•†åº—'" class="grid grid-cols-2 gap-3">
                    <div v-for="r in foodSpots[foodLoc]" :key="r.name" class="card p-0">
                        <div class="h-32 bg-gray-200"><img :src="getUnsplashUrl(r.key)" class="w-full h-full object-cover"></div>
                        <div class="p-2">
                            <div class="font-bold text-sm truncate">{{r.name}}</div>
                            <div class="text-[10px] text-gray-500 mb-2">{{r.desc}}</div>
                            <a :href="r.link || getMapLink(r.name)" target="_blank" class="block bg-gray-100 text-center py-1 rounded text-[10px] font-bold">å°èˆª</a>
                        </div>
                    </div>
                </div>

                <div v-else class="space-y-6">
                    <div v-for="(items, store) in cvsFoods" :key="store">
                        <h3 class="font-black text-lg mb-2 pl-2 border-l-4" :class="store==='Lawson'?'border-blue-500 text-blue-500':store==='7-11'?'border-green-500 text-green-600':'border-green-400 text-green-500'">{{store}}</h3>
                        <div class="cvs-grid">
                            <div v-for="item in items" class="cvs-card">
                                <div class="text-xs font-bold text-gray-700">{{item}}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentView==='photo'" class="space-y-4">
                <div v-for="loc in ['æ±äº¬','éŒå€‰','å¯Œå£«å±±']" :key="loc">
                    <h3 class="font-black text-pink-500 mb-2 pl-2">{{loc}}</h3>
                    <div class="flex gap-3 overflow-x-auto hide-scrollbar pb-2">
                        <div v-for="p in photoSpots[loc]" class="shrink-0 w-40 card p-0">
                            <div class="h-28 bg-gray-200"><img :src="getUnsplashUrl(p.key)" class="w-full h-full object-cover"></div>
                            <div class="p-2">
                                <div class="font-bold text-xs">{{p.name}}</div>
                                <a :href="p.link || getMapLink(p.name)" target="_blank" class="text-[10px] text-blue-400 font-bold">ğŸ“ åœ°åœ–</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentView==='shopping'">
                <div class="flex gap-2 mb-4">
                    <a href="https://www.cosme.net/ranking/" target="_blank" class="flex-1 bg-green-100 text-green-600 text-center py-2 rounded-xl font-bold text-xs">ğŸ‘‘ COSME å¤§è³</a>
                    <a href="https://www.shinyusha.co.jp/media/ldk-the-beauty/" target="_blank" class="flex-1 bg-pink-100 text-pink-600 text-center py-2 rounded-xl font-bold text-xs">ğŸ’„ LDK æ¯’èˆŒé›œèªŒ</a>
                </div>
                <div class="flex gap-2 overflow-x-auto mb-4">
                    <a href="https://www.djapanpass.com/" class="px-3 py-1 bg-yellow-100 text-yellow-600 rounded-full text-xs font-bold whitespace-nowrap">å”å‰è¨¶å¾·å„ªæƒ åˆ¸</a>
                    <a href="https://www.biccamera.com/" class="px-3 py-1 bg-red-100 text-red-600 rounded-full text-xs font-bold whitespace-nowrap">Bic Camera å„ªæƒ åˆ¸</a>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div v-for="s in shopping.cosme" class="card p-3">
                        <div class="h-24 bg-gray-100 mb-2 rounded overflow-hidden"><img :src="getUnsplashUrl(s.name)" class="w-full h-full object-cover"></div>
                        <div class="font-bold text-xs mb-1">{{s.name}}</div>
                        <div class="text-[10px] text-gray-400">è—¥å¦å¿…è²·</div>
                    </div>
                </div>
            </div>

            <div v-if="currentView==='weather'">
                <div class="card p-4 mb-4 bg-pink-50 border-pink-200">
                    <h3 class="font-black text-pink-500 mb-2">ğŸŒ¸ æ«»èŠ±æœ€å‰ç·š</h3>
                    <div class="flex gap-2">
                        <a href="https://weathernews.jp/s/sakura/" target="_blank" class="flex-1 bg-white py-2 rounded text-center text-xs font-bold shadow text-pink-400">Weathernews</a>
                        <a href="https://tenki.jp/sakura/" target="_blank" class="flex-1 bg-white py-2 rounded text-center text-xs font-bold shadow text-pink-400">æ—¥æœ¬æ°£è±¡å”æœƒ</a>
                    </div>
                </div>
                <div class="card p-6 bg-blue-400 text-white">
                    <div class="flex justify-between items-center">
                        <div><div class="text-xs font-bold opacity-80">TOKYO</div><div class="text-5xl font-black">18Â°C</div></div>
                        <i class="fa-solid fa-cloud-sun text-4xl"></i>
                    </div>
                    <div class="mt-2 bg-white/20 inline-block px-3 py-1 rounded-full text-xs font-bold">å»ºè­°ï¼šå¤§è¡£ + åœå·¾</div>
                </div>
            </div>

            <div v-if="currentView==='emergency'">
                <div class="emer-grid mb-20">
                    <div class="emer-box bg-white border-red-100"><div class="font-black text-gray-800 mb-2">å ±è­¦ 110</div><a href="tel:110" class="block bg-gray-800 text-white text-center py-2 rounded-lg text-xs font-bold">æ’¥æ‰“</a></div>
                    <div class="emer-box bg-white border-blue-100"><div class="font-black text-blue-800 mb-2">æ•‘è­· 119</div><a href="tel:119" class="block bg-blue-500 text-white text-center py-2 rounded-lg text-xs font-bold">æ’¥æ‰“</a></div>
                </div>
                <div class="space-y-2 mb-20">
                    <div v-for="p in phrases" class="card p-3 border-l-4 border-indigo-400">
                        <div class="font-bold text-gray-800">{{p.jp}}</div><div class="text-xs text-gray-500">{{p.zh}}</div>
                    </div>
                </div>
                <div class="fixed bottom-24 right-4 flex flex-col gap-3">
                    <button @click="camTrans" class="w-12 h-12 rounded-full bg-gray-800 text-white flex items-center justify-center shadow-lg"><i class="fa-solid fa-camera"></i></button>
                </div>
            </div>

        </div> <div v-if="currentView!=='menu'" class="fab-home" @click="currentView='menu'"><i class="fa-solid fa-house"></i></div>

    </div>
</div>

<script type="module">
import { createApp, ref, computed } from "https://unpkg.com/vue@3.3.4/dist/vue.esm-browser.js";

// V69.0 å®Œæ•´è©³ç´°è¡Œç¨‹è³‡æ–™
const hardcodedData = {
    users: [{id:1,name:'å‰ä¼Š',icon:'ğŸ¹'},{id:2,name:'å°å…«',icon:'ğŸ±'},{id:3,name:'å…”å…”',icon:'ğŸ°'},{id:4,name:'å°æ¡ƒ',icon:'ğŸ‘'}],
    hotels: [
        {name:'éŒ¦ç³»ç”º Sumida City', key:'hotel room', link:'https://maps.app.goo.gl/4WscHTq9R7eK5fGC8'},
        {name:'Megu Fuji 2021', key:'mt fuji hotel', link:'https://maps.app.goo.gl/MsiGap6HiHFwQ7yh8'},
        {name:'DOMO é£¯åº—', key:'tokyo hotel', link:'https://maps.app.goo.gl/1kLupuWjXwntskSq9'}
    ],
    // é™£åˆ—çµæ§‹ï¼šIndex 0=Day1 ... Index 2=Day3
    itineraryNormal: [
        [{time:'06:40', title:'æ¡ƒåœ’èµ·é£› -> æˆç”°', desc:'10:40æŠµé”, è²·Suica'}, {time:'14:00', title:'æ™´ç©ºå¡”', desc:'ä¸‹åˆèŒ¶ & é€›è¡—', map:'æ±äº¬æ™´ç©ºå¡”'}, {time:'18:00', title:'éŒ¦ç³¸ç”ºæ™šé¤', desc:'ç‡’è‚‰/å±…é…’å±‹', map:'éŒ¦ç³¸ç”ºç«™'}],
        [{time:'09:00', title:'æ·ºè‰å¯º', desc:'é›·é–€æ‹ç…§'}, {time:'12:00', title:'æ·ºè‰åˆé¤', desc:'ç‚¸ç‰›æ’'}, {time:'14:00', title:'å°ç¶²ç¥ç¤¾', desc:'å¼·é‹å„é™¤'}, {time:'15:00', title:'ä¸Šé‡å…¬åœ’', desc:'æ•£æ­¥'}, {time:'19:00', title:'ç§‹è‘‰åŸ/ä¸€ç•ªè¡—', desc:'æ™šé¤ä¾é€›è¡—æ±ºå®š'}],
        [{time:'08:00', title:'å‰å¾€å¯Œå£«å±±', desc:'éŒ¦ç³¸ç”ºæ­å¯Œå£«å›éŠ', map:'éŒ¦ç³¸ç”ºç«™'}, {time:'11:00', title:'æŠµé”æ²³å£æ¹–', desc:'æ­å·´å£«/çºœè»Š', map:'æ²³å£æ¹–ç«™'}, {time:'13:00', title:'æ²³å£æ¹–è‡ªç„¶ç”Ÿæ´»é¤¨', desc:'å¤§çŸ³å…¬åœ’'}, {time:'19:00', title:'ä¸å‹•èŒ¶å±‹', desc:'é¤ºé£¥éºµ'}], // Day 3 ä¸€èˆ¬
        [{time:'09:00', title:'å¿é‡å…«æµ·', desc:'æ¹§æ³‰ç¾¤'}, {time:'12:00', title:'å±±ä¸­æ¹–', desc:'æ­å·´å£«å‰å¾€'}, {time:'14:00', title:'KABA å·´å£«', desc:'æ°´é™¸å…©ç”¨'}, {time:'18:00', title:'æ™šé¤', desc:'è¶…å¸‚ç†Ÿé£Ÿ'}], // Day 4 ä¸€èˆ¬
        [{time:'09:00', title:'æ–°å€‰å±±æ·ºé–“å…¬åœ’', desc:'äº”é‡å¡”'}, {time:'11:00', title:'é‡‘é³¥å±…', desc:'æ‹ç…§'}, {time:'14:00', title:'å¯Œå£«å›éŠè¿”æ±äº¬', desc:'å›æ–°å®¿æ”¾è¡Œæ'}, {time:'17:00', title:'æ± è¢‹å¤ªé™½åŸ', desc:'é€›è¡—æ™šé¤'}],
        [{time:'09:00', title:'æ–°å®¿ -> è—¤æ¾¤', desc:'æ±Ÿä¹‹é›»ä¸€æ—¥éŠ'}, {time:'10:30', title:'æ±Ÿä¹‹å³¶', desc:'ç¥ç¤¾/è€è¡—'}, {time:'12:30', title:'éŒå€‰é«˜æ ¡å‰', desc:'å¹³äº¤é“æ‹ç…§'}, {time:'13:30', title:'ä¸ƒé‡Œæ¿±', desc:'Bills åˆé¤'}, {time:'16:00', title:'éŒå€‰/é¶´å²¡å…«å¹¡å®®', desc:'å°ç”ºé€š'}, {time:'19:00', title:'è¿”å›æ–°å®¿', desc:'æ™šé¤'}],
        [{time:'09:00', title:'æ±äº¬éµå¡”', desc:'èŠå…¬åœ’/å…­æœ¬æœ¨'}, {time:'12:00', title:'å…­æœ¬æœ¨åˆé¤', desc:'æ•˜æ•˜è‹‘?'}, {time:'14:00', title:'æ¾€è°·é€›è¡—', desc:'Parco/109'}, {time:'17:00', title:'SHIBUYA SKY', desc:'æ—¥è½æ™‚æ®µ'}, {time:'19:00', title:'æ¾€è°·æ™šé¤', desc:'å±…é…’å±‹'}],
        [{time:'10:00', title:'æœ€å¾Œæ¡è²·', desc:'ä¸Šé‡é˜¿ç¾æ©«ä¸'}, {time:'16:00', title:'Skyliner', desc:'å‰å¾€æˆç”°æ©Ÿå ´'}, {time:'20:40', title:'æˆç”°èµ·é£› -> æ¡ƒåœ’', desc:'23:20 æŠµé”'}]
    ],
    // è‡ªé§•å°ˆç”¨è³‡æ–™ (Day 3 & 4)
    drivePlan: [
        [{time:'08:00', title:'å‰å¾€å¯Œå£«å±±', desc:'éŒ¦ç³¸ç”ºå‡ºç™¼', map:'éŒ¦ç³¸ç”ºç«™'}, {time:'10:30', title:'é–‹å§‹ç§Ÿè»Š', desc:'æ²³å£æ¹–ç«™å‰åº—', map:'Toyota Rent a Car Kawaguchiko'}, {time:'13:00', title:'æ²³å£æ¹–è‡ªç„¶ç”Ÿæ´»é¤¨', desc:'å¤§çŸ³å…¬åœ’çµ•æ™¯', map:'å¤§çŸ³å…¬åœ’'}, {time:'15:00', title:'æ–°å€‰å±±æ·ºé–“å…¬åœ’', desc:'å¿ éˆå¡”', map:'æ–°å€‰å±±æ·ºé–“å…¬åœ’'}, {time:'17:30', title:'é‡‘é³¥å±…/æœ¬ç”ºé€š', desc:'æ—¥å·æ™‚è¨ˆåº—æ‹ç…§', map:'æ—¥å·æ™‚è¨ˆåº—'}, {time:'19:00', title:'æ™šé¤', desc:'è‡ªè¡Œçƒ¹é£ªæˆ–å•†åº—è¡—'}], // Day 3 è‡ªé§•
        [{time:'05:00', title:'å¹³é‡ä¹‹æ¿±', desc:'çœ‹æ—¥å‡º (é–‹è»Š)', map:'å¹³é‡ã®æµœ'}, {time:'09:00', title:'é•·æ± è¦ªæ°´å…¬åœ’', desc:'ç™½é³¥æ¿±/ç§Ÿè…³è¸è»Š', map:'é•·æ± è¦ªæ°´å…¬åœ’'}, {time:'12:00', title:'å±±ä¸­æ¹–åˆé¤', desc:'æ¹–ç•”é¤å»³'}, {time:'14:00', title:'KABA æ°´é™¸å·´å£«', desc:'æ—­æ—¥ä¸˜', map:'KABA BUS'}, {time:'18:00', title:'Ogino è¶…å¸‚', desc:'è²·é£Ÿæå›æ°‘å®¿ç…®', map:'Ogino Kawaguchiko'}] // Day 4 è‡ªé§•
    ],
    food: {
        'æ±äº¬': [{name:'å™å™è‹‘',desc:'é«˜ç´šç‡’è‚‰',key:'yakiniku',link:''},{name:'AFURI',desc:'æŸšå­é¹½æ‹‰éºµ',key:'ramen',link:''},{name:'HARBS',desc:'æ°´æœåƒå±¤',key:'cake',link:''},{name:'ç‰›ã‹ã¤ã‚‚ã¨æ‘',desc:'ç‚¸ç‰›æ’',key:'beef cutlet',link:''},{name:'å…­å˜èˆ',desc:'æ²¾éºµ',key:'tsukemen',link:''}],
        'å¯Œå£«å±±': [{name:'ä¸å‹•èŒ¶å±‹',desc:'é¤ºé£¥éºµ',key:'hoto noodle',link:''},{name:'å±±éº“åœ’',desc:'çˆç«¯ç‡’',key:'irori',link:''},{name:'ç„¼è‚‰ã²ã¾ã‚ã‚Š',desc:'ç‡’è‚‰',key:'bbq',link:''},{name:'Lake Bake',desc:'æ¹–ç•”éºµåŒ…',key:'bakery',link:''},{name:'Ogino',desc:'è¶…å¸‚ç†Ÿé£Ÿ',key:'supermarket food',link:''}],
        'éŒå€‰': [{name:'Bills',desc:'é¬†é¤…',key:'pancakes',link:''},{name:'Pacific Drive-in',desc:'æµ·æ™¯å’–å•¡',key:'cafe sea',link:''},{name:'Caraway',desc:'å’–å“©',key:'curry',link:''},{name:'å»ä»”é­šä¸¼',desc:'æ±Ÿä¹‹å³¶ç‰¹ç”¢',key:'whitebait bowl',link:''},{name:'åŠ›é¤…å®¶',desc:'å’Œè“å­',key:'mochi',link:''}]
    },
    cvs: {
        'Lawson': ['ç‚¸é›å›','æƒ¡é­”é£¯ç³°','ç”Ÿä¹³æ²','å·´æ–¯å…‹èµ·å¸è›‹ç³•','çƒ¤é›è‚‰ä¸²'],
        '7-11': ['ç ‚ç³–å¥¶æ²¹æ¨¹','åŠç†Ÿè›‹é£¯ç³°','é—œæ±ç…®','åƒå±¤è›‹ç³•','å’–å•¡'],
        'FamilyMart': ['å…¨å®¶ç‚¸é›','èˆ’èŠ™é›·å¸ƒä¸','ç‰§å ´ç‰›å¥¶å†°','é®ªé­šé£¯ç³°','çƒ¤åœ°ç“œ']
    },
    shopping: [{name:'Canmake è…®ç´…'},{name:'Excel çœ¼å½±'},{name:'Minon é¢è†œ'},{name:'NY Perfect Cheese'},{name:'Press Butter Sand'}],
    phrases: [{jp:'ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹',zh:'å»æ‰€åœ¨å“ª'},{jp:'ã“ã‚Œãã ã•ã„',zh:'æˆ‘è¦é€™å€‹'},{jp:'ã„ãã‚‰ã§ã™ã‹',zh:'å¤šå°‘éŒ¢'},{jp:'ãŠä¼šè¨ˆãŠé¡˜ã„ã—ã¾ã™',zh:'çµå¸³'},{jp:'ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¯ä½¿ãˆã¾ã™ã‹',zh:'å¯åˆ·å¡å—'}],
    photo: {
        'æ±äº¬': [{name:'SHIBUYA SKY',key:'shibuya sky',link:''},{name:'æ±äº¬éµå¡”',key:'tokyo tower',link:''}],
        'å¯Œå£«å±±': [{name:'ä¸‹å‰ç”°æœ¬ç”ºé€š',key:'mt fuji street',link:''},{name:'é€†å¯Œå£«',key:'lake kawaguchi',link:''}],
        'éŒå€‰': [{name:'éŒå€‰é«˜æ ¡å‰',key:'slam dunk crossing',link:''},{name:'é•·è°·å¯º',key:'hasedera',link:''}]
    }
};

createApp({
    setup() {
        const isLoading = ref(true);
        const isWelcomeClosed = ref(false);
        const currentView = ref('welcome');
        const isLoggedIn = ref(false); 
        const users = ref(hardcodedData.users);
        const currentUser = ref(null);
        const isGuest = ref(false);
        
        // Data
        const hotels = ref(hardcodedData.hotels);
        const foodSpots = ref(hardcodedData.food);
        const cvsFoods = ref(hardcodedData.cvs);
        const shopping = ref({cosme: hardcodedData.shopping});
        const photoSpots = ref(hardcodedData.photo);
        const phrases = ref(hardcodedData.phrases);
        
        // Itinerary Logic
        const tripDays = [
            {label:'D1', hp:100}, {label:'D2', hp:80}, {label:'D3', hp:60}, {label:'D4', hp:50}, 
            {label:'D5', hp:70}, {label:'D6', hp:90}, {label:'D7', hp:80}, {label:'D8', hp:100}
        ];
        const dayIdx = ref(0);
        const driveMode = ref(true); // Default drive for Day 3/4
        
        // Helpers
        const getCurrentItinerary = () => {
            // Day 3 (Index 2) and Day 4 (Index 3) have Drive Mode
            if (driveMode.value && (dayIdx.value === 2 || dayIdx.value === 3)) {
                // Map Day 3 -> Index 0 of drivePlan, Day 4 -> Index 1
                const driveIndex = dayIdx.value - 2;
                return hardcodedData.drivePlan[driveIndex] || [];
            }
            return hardcodedData.itineraryNormal[dayIdx.value] || [];
        };

        const foodLoc = ref('æ±äº¬');
        const hotelTab = ref('ä½å®¿');
        const moneyMode = ref('private');
        const rate = ref(0.215);
        
        const daysUntilTrip = ref(Math.ceil((new Date('2026-03-27') - new Date())/(1000*60*60*24)));
        const budgetAlert = ref(false); 
        const myPrepList = ref([{text:'è­·ç…§',checked:false},{text:'ç¶²å¡',checked:false},{text:'æ—¥å¹£',checked:true}]);
        
        const myTotal = ref(15000);
        const myExpenses = ref([{item:'æ‹‰éºµ',amount:1000,currency:'JPY'},{item:'è»Šç¥¨',amount:500,currency:'JPY'}]);
        const settlements = ref([{from:'å‰ä¼Š',to:'å°å…«',amount:2000}]);
        const publicExpenses = ref([{item:'ç§Ÿè»Šé¦–ä»˜',payer:'å°å…«',amount:15000,share:4,currency:'JPY'}]);

        const apps = [
            {id:1,name:'è¡Œç¨‹è¡¨',icon:'fa-solid fa-map',view:'itinerary',bgClass:'bg-pink-400'},
            {id:2,name:'å°è²¡åº«',icon:'fa-solid fa-yen-sign',view:'money',bgClass:'bg-yellow-400'},
            {id:3,name:'ä½å®¿äº¤é€š',icon:'fa-solid fa-hotel',view:'hotel',bgClass:'bg-indigo-400'},
            {id:4,name:'è¡Œå‰æº–å‚™',icon:'fa-solid fa-suitcase',view:'prep',bgClass:'bg-blue-400'},
            {id:5,name:'ç¾é£Ÿåœ°åœ–',icon:'fa-solid fa-utensils',view:'food',bgClass:'bg-orange-400'},
            {id:6,name:'å¿…æ‹æ©Ÿä½',icon:'fa-solid fa-camera',view:'photo',bgClass:'bg-rose-400'},
            {id:7,name:'å¿«æ¨‚è³¼',icon:'fa-solid fa-bag-shopping',view:'shopping',bgClass:'bg-purple-400'},
            {id:8,name:'å¤©æ°£é å ±',icon:'fa-solid fa-cloud-sun',view:'weather',bgClass:'bg-sky-400'},
            {id:9,name:'æ€¥æ•‘åŒ…',icon:'fa-solid fa-kit-medical',view:'emergency',bgClass:'bg-red-400'}
        ];

        const enterSite = () => { isWelcomeClosed.value=true; currentUser.value=users.value[0]; setTimeout(()=>isLoading.value=false, 500); };
        const handleAuthClick = () => { isLoggedIn.value=!isLoggedIn.value; };
        const getUnsplashUrl = (k) => `https://source.unsplash.com/400x300/?${encodeURIComponent(k)}`;
        const getPageTitle = (v) => apps.find(a=>a.view===v)?.name || 'é—œæ±ä¹‹æ—…';
        const getUncheckedCount = () => myPrepList.value.filter(i=>!i.checked).length;
        const camTrans = () => window.open('https://translate.google.com/?sl=auto&tl=zh-TW&op=images');
        const getMapLink = (k) => `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(k)}`;
        
        const moveItem = () => {}; const editItem = () => {}; const addItem = () => {};
        const quickExpense = () => {}; const deleteExpense = () => {}; const addExpense = () => {}; const addPrepItem = () => {};

        setTimeout(() => isLoading.value=false, 1000); 

        return {
            isLoading, isWelcomeClosed, currentView, isLoggedIn, users, currentUser,
            apps, daysUntilTrip, budgetAlert, tripDays,
            dayIdx, foodLoc, hotelTab, driveMode, moneyMode, rate,
            hotels, foodSpots, cvsFoods, shopping, photoSpots, phrases,
            myPrepList, myTotal, myExpenses, settlements, publicExpenses,
            enterSite, handleAuthClick, getUnsplashUrl, getPageTitle, getCurrentItinerary, getUncheckedCount, camTrans, getMapLink,
            moveItem, editItem, addItem, quickExpense, deleteExpense, addExpense, addPrepItem
        };
    }
}).mount('#app');
</script>
</body>
</html>
