<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é—œæ±8æ—¥ä¹‹æ—… V4.6 (Debug)</title>
    
    <style>
        #debug-console {
            position: fixed; top: 0; left: 0; width: 100%; height: 150px;
            background: black; color: lime; z-index: 999999;
            overflow-y: scroll; font-family: monospace; font-size: 12px;
            padding: 10px; opacity: 0.9; display: none; /* é è¨­éš±è—ï¼Œæœ‰éŒ¯æ‰é–‹ */
        }
        .close-debug { float: right; color: white; border: 1px solid white; padding: 2px 5px; }
    </style>

    <script>
        window.onerror = function(msg, url, line, col, error) {
            var consoleBox = document.getElementById('debug-console');
            if (consoleBox) {
                consoleBox.style.display = 'block';
                consoleBox.innerHTML += "<div style='border-bottom:1px solid #333; margin-bottom:5px;'>" +
                    "<strong>â›” ç™¼ç”ŸéŒ¯èª¤:</strong> " + msg + "<br>" +
                    "Line: " + line + "</div>";
            }
            // å¼·åˆ¶ç§»é™¤è¼‰å…¥é®ç½©ï¼Œè®“ä½¿ç”¨è€…è‡³å°‘çœ‹å¾—åˆ°ä»‹é¢
            var loader = document.getElementById('static-loading');
            if(loader) loader.style.display = 'none';
            return false;
        };
        console.error = (function(old) {
            return function(text) {
                old(text);
                var consoleBox = document.getElementById('debug-console');
                if (consoleBox) {
                    consoleBox.style.display = 'block';
                    consoleBox.innerHTML += "<div style='color:orange;'>âš ï¸ Console Error: " + text + "</div>";
                }
            }
        })(console.error);
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'chii-pink': '#FFD1DC', 'chii-deep-pink': '#FF9EAC', 'chii-blue': '#A2D2FF', 'chii-yellow': '#FFF5BA', 'chii-text': '#5D4037' },
                    fontFamily: { sans: ['Zen Maru Gothic', 'sans-serif'] },
                    animation: { 'bounce-slow': 'bounce 3s infinite', 'wiggle': 'wiggle 1s ease-in-out infinite' },
                    keyframes: { wiggle: { '0%, 100%': { transform: 'rotate(-3deg)' }, '50%': { transform: 'rotate(3deg)' } } }
                }
            }
        }
    </script>
    <style>
        body { margin: 0; background-color: #FFF0F5; background-image: radial-gradient(#FFD1DC 15%, transparent 16%), radial-gradient(#FFF5BA 15%, transparent 16%); background-size: 60px 60px; background-position: 0 0, 30px 30px; font-family: sans-serif; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        /* è¼‰å…¥ç•«é¢ */
        #static-loading { position: fixed; inset: 0; background: #FFF0F5; z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s; }
        .banner-img { width: 100%; height: 100%; object-fit: cover; object-position: center bottom; }
        .card { background: rgba(255, 255, 255, 0.95); border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .fab-main { position: fixed; bottom: 30px; right: 20px; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; z-index: 50; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        /* ç¢ºä¿å…§å®¹ä¸€å®šé¡¯ç¤º */
        #app { display: block; opacity: 1; }
    </style>
</head>
<body>

    <div id="debug-console">
        <button class="close-debug" onclick="document.getElementById('debug-console').style.display='none'">X é—œé–‰</button>
        <div><strong>ğŸ”§ é™¤éŒ¯æ¨¡å¼å•Ÿå‹• (V4.6)</strong> - å¦‚æœçœ‹åˆ°é€™å€‹é»‘æ¡†ï¼Œè«‹æˆªåœ–çµ¦é–‹ç™¼è€…ã€‚</div>
    </div>

    <div id="static-loading">
        <div style="font-size: 50px;">ğŸŒ¸</div>
        <div style="margin-top: 10px; font-weight: bold; color: #555;">è¼‰å…¥ä¸­...</div>
        <button onclick="document.getElementById('static-loading').style.display='none'" style="margin-top:20px; padding:8px 16px; border-radius:20px; border:1px solid #999;">å¼·åˆ¶é€²å…¥</button>
    </div>

    <div id="app" class="min-h-screen pb-20">
        
        <div v-if="currentView !== 'home'" class="fixed top-0 left-0 right-0 h-16 bg-[#FFF0F5]/95 backdrop-blur z-40 flex items-center justify-between px-4 border-b border-pink-100 shadow-sm">
            <button @click="currentView='home'" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-pink-400 shadow"><i class="fa-solid fa-chevron-left"></i></button>
            <h1 class="font-bold text-gray-700">{{ getPageTitle(currentView) }}</h1>
            <button @click="downloadBackup" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-blue-400 shadow"><i class="fa-solid fa-download"></i></button>
        </div>
        <div v-if="currentView !== 'home'" class="h-16"></div>

        <div v-if="currentView === 'home'" class="relative h-screen flex flex-col">
            <div class="absolute inset-0 z-0"><img :src="homeBannerImg" class="w-full h-full object-cover object-bottom" @error="e=>e.target.src='https://placehold.co/600x800/pink/white?text=Banner'"><div class="absolute inset-0 bg-black/20"></div></div>
            <div class="relative z-10 flex-1 flex flex-col justify-between p-6 pt-12">
                <div class="text-center text-white drop-shadow-md">
                    <div class="bg-pink-500/80 px-3 py-1 rounded-full inline-block text-sm font-bold mb-2">2026.03.27 å‡ºç™¼</div>
                    <h1 class="text-5xl font-black mb-1">é—œæ±ä¹‹æ—…</h1>
                    <p class="text-lg opacity-90 tracking-widest">8å¤©7å¤œ</p>
                </div>
                <div class="bg-white/80 backdrop-blur rounded-3xl p-5 shadow-xl grid grid-cols-3 gap-6">
                    <div v-for="app in apps" :key="app.id" @click="currentView=app.view" class="flex flex-col items-center">
                        <div class="w-14 h-14 rounded-2xl flex items-center justify-center text-2xl text-white shadow-md border-2 border-white" :class="app.bgClass"><i :class="app.icon"></i></div>
                        <span class="text-xs font-bold mt-2 text-gray-700">{{app.name}}</span>
                    </div>
                </div>
                <div class="bg-white/90 rounded-full p-2 flex shadow-lg">
                    <input v-model="searchQuery" placeholder="æœå°‹æ±äº¬..." class="flex-1 bg-transparent px-3 outline-none">
                    <button @click="doSearch" class="bg-pink-400 text-white w-10 h-10 rounded-full"><i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'itinerary'" class="px-4 py-2">
            <div class="flex overflow-x-auto gap-2 mb-4 pb-1">
                <button v-for="(d,i) in tripDays" @click="selectedDayIndex=i" :class="['px-4 py-2 rounded-full whitespace-nowrap text-sm font-bold border-2', selectedDayIndex===i?'bg-pink-400 text-white border-pink-400':'bg-white text-gray-400 border-white']">{{d}}</button>
            </div>
            <div class="space-y-4">
                <div v-for="(item, idx) in currentItinerary" :key="idx" class="card p-4 flex gap-3 relative">
                    <div class="w-1 bg-pink-200 absolute left-3 top-4 bottom-4 rounded"></div>
                    <div class="text-2xl w-10 text-center relative z-10 bg-white rounded-full h-10 flex items-center justify-center shadow-sm">ğŸ“</div>
                    <div class="flex-1">
                        <div class="flex justify-between mb-1"><span class="bg-pink-100 text-pink-600 text-xs px-2 py-0.5 rounded font-bold">{{item.hours}}</span></div>
                        <h3 class="font-bold text-lg text-gray-800">{{item.name}}</h3>
                        <p class="text-sm text-gray-500">{{item.note}}</p>
                        <a v-if="item.mapKeyword" :href="'https://www.google.com/maps/search/?api=1&query='+item.mapKeyword" target="_blank" class="text-xs text-blue-500 mt-2 inline-block"><i class="fa-solid fa-map"></i> å°èˆª</a>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'money'" class="px-4 py-2">
            <div class="flex gap-2 mb-4 bg-white p-1 rounded-xl shadow-sm"><button @click="moneyTab='record'" class="flex-1 py-2 rounded-lg font-bold" :class="moneyTab==='record'?'bg-yellow-200':'text-gray-400'">è¨˜å¸³</button><button @click="moneyTab='split'" class="flex-1 py-2 rounded-lg font-bold" :class="moneyTab==='split'?'bg-blue-200':'text-gray-400'">åˆ†å¸³</button></div>
            <div v-if="moneyTab==='record'" class="space-y-3">
                <div class="card p-4 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200"><div class="text-xs text-yellow-700">ç¸½æ”¯å‡º</div><div class="text-2xl font-black">Â¥{{totalExpense}}</div></div>
                <div v-for="e in expenses" class="card p-3 flex justify-between"><span>{{e.name}}</span><span class="font-bold">Â¥{{e.amount}}</span></div>
                <button @click="addExpense" class="fab-main bg-yellow-400 text-black"><i class="fa-solid fa-plus"></i></button>
            </div>
        </div>

        <div v-if="['prep','weather','food','shopping','photo','hotel','japanese'].includes(currentView)" class="px-4 py-10 text-center text-gray-400">
            <div class="text-6xl mb-4">ğŸš§</div>
            <p>é é¢å»ºç½®ä¸­...</p>
            <p class="text-xs mt-2">è‹¥éœ€å®Œæ•´åŠŸèƒ½è«‹ç¢ºèªè³‡æ–™çµæ§‹æ­£ç¢º</p>
        </div>

    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        createApp({
            setup() {
                const currentView = ref('home');
                const homeBannerImg = ref('2026.tokyo.jpg');
                const searchQuery = ref('');
                const selectedDayIndex = ref(0);
                const tripDays = ['Day 1','Day 2','Day 3','Day 4','Day 5','Day 6','Day 7','Day 8'];
                
                // ç‚ºäº†é¿å…èªæ³•éŒ¯èª¤ï¼Œé€™è£¡åªæ”¾æœ€æ ¸å¿ƒçš„å‡è³‡æ–™ã€‚å¦‚æœé€™èƒ½è·‘ï¼Œä»£è¡¨å•é¡Œå‡ºåœ¨è³‡æ–™å¤ªé•·ã€‚
                const itinerary = ref([
                    [{hours:'06:40', name:'æ¡ƒåœ’èµ·é£›', note:'ææ—©åˆ°', mapKeyword:'æ¡ƒåœ’æ©Ÿå ´'}],
                    [{hours:'09:00', name:'æ·ºè‰å¯º', note:'é›·é–€', mapKeyword:'æ·ºè‰å¯º'}],
                    [], [], [], [], [], []
                ]);
                
                const expenses = ref([{name:'æ‹‰éºµ', amount:1000}]);
                const moneyTab = ref('record');

                const apps = [
                    { id: 1, name: 'è¡Œç¨‹è¡¨', icon: 'fa-solid fa-map-location-dot', bgClass: 'bg-gradient-to-br from-pink-400 to-pink-300', view: 'itinerary' },
                    { id: 2, name: 'å°è²¡åº«', icon: 'fa-solid fa-sack-dollar', bgClass: 'bg-gradient-to-br from-yellow-300 to-orange-300', view: 'money' },
                    { id: 3, name: 'ä½å®¿', icon: 'fa-solid fa-bed', bgClass: 'bg-gradient-to-br from-indigo-400 to-blue-400', view: 'hotel' },
                    { id: 4, name: 'æº–å‚™', icon: 'fa-solid fa-suitcase', bgClass: 'bg-gradient-to-br from-blue-400 to-cyan-400', view: 'prep' },
                    { id: 5, name: 'åƒå–', icon: 'fa-solid fa-utensils', bgClass: 'bg-gradient-to-br from-orange-400 to-amber-400', view: 'food' },
                    { id: 6, name: 'è³¼ç‰©', icon: 'fa-solid fa-bag-shopping', bgClass: 'bg-gradient-to-br from-purple-400 to-fuchsia-400', view: 'shopping' },
                    { id: 7, name: 'å¤©æ°£', icon: 'fa-solid fa-cloud-sun', bgClass: 'bg-gradient-to-br from-sky-400 to-cyan-300', view: 'weather' },
                    { id: 8, name: 'æ‰“å¡', icon: 'fa-solid fa-camera', bgClass: 'bg-gradient-to-br from-rose-400 to-red-300', view: 'photo' },
                    { id: 9, name: 'æ—¥æ–‡', icon: 'fa-solid fa-comment', bgClass: 'bg-gradient-to-br from-emerald-400 to-green-400', view: 'japanese' },
                ];

                const currentItinerary = computed(() => itinerary.value[selectedDayIndex.value] || []);
                const totalExpense = computed(() => expenses.value.reduce((a,b)=>a+Number(b.amount),0));
                
                const getPageTitle = (v) => {
                    const map = {'itinerary':'è¡Œç¨‹è¡¨', 'money':'å°è²¡åº«', 'home':'é¦–é '};
                    return map[v] || 'åŠŸèƒ½é é¢';
                };

                const doSearch = () => { if(searchQuery.value) window.open('https://www.google.com/maps/search/?api=1&query='+searchQuery.value); };
                const addExpense = () => { 
                    const n = prompt('é …ç›®'); const a = prompt('é‡‘é¡'); 
                    if(n&&a) expenses.value.push({name:n, amount:a}); 
                };
                const downloadBackup = () => {
                    alert('å‚™ä»½åŠŸèƒ½æ­£å¸¸');
                };

                onMounted(() => {
                    // å¼·åˆ¶ç§»é™¤è¼‰å…¥ç•«é¢ (å°±ç®— Vue æ²’å®Œå…¨è·‘å®Œ)
                    setTimeout(() => {
                        const loader = document.getElementById('static-loading');
                        if(loader) loader.style.display = 'none';
                    }, 500);
                });

                return {
                    currentView, homeBannerImg, searchQuery, apps, tripDays, selectedDayIndex,
                    itinerary, currentItinerary, getPageTitle, doSearch,
                    moneyTab, expenses, totalExpense, addExpense, downloadBackup
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
